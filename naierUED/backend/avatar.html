<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>首页</title>
  <!-- Bootstrap 3.3.6 -->
  <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="dist/css/font-awesome.min.css">
  <link rel="stylesheet" href="plugins/select2/select2.min.css" type="text/css" media="all" />
  <!-- Theme style -->
  <link rel="stylesheet" href="dist/css/AdminLTE.min.css">
  <link rel="stylesheet" href="dist/css/skins/_all-skins.min.css">
  
  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="dist/js/html5shiv.min.js"></script>
  <script src="dist/js/respond.min.js"></script>
  <![endif]-->
</head>
<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">

  <header class="main-header">
    <!-- Logo -->
    <a href="index2.html" class="logo">
      <!-- mini logo for sidebar mini 50x50 pixels -->
      <span class="logo-mini"><b>古北</b></span>
      <!-- logo for regular state and mobile devices -->
      <span class="logo-lg"><b>上海古北一店</b></span>
    </a>
    <!-- Header Navbar: style can be found in header.less -->
    <nav class="navbar navbar-static-top">
      <!-- Sidebar toggle button-->
      <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
        <span class="sr-only">Toggle navigation</span>
      </a>

      <div class="navbar-custom-menu">
        <ul class="nav navbar-nav">
          <li class="user user-menu">
            <a href="#">
              <img alt="User Image" class="user-image" src="dist/images/avatar.png">
              <span class="hidden-xs">懒得想</span>
            </a>
          </li>
          <li>
            <a href="#">退出</a>
          </li>
        </ul>
      </div>
    </nav>
  </header>
  <!-- Left side column. contains the logo and sidebar -->
  <aside class="main-sidebar">
    <!-- sidebar: style can be found in sidebar.less -->
    <section class="sidebar">
      <!-- sidebar menu: : style can be found in sidebar.less -->
      <ul class="sidebar-menu">
        <li class="header">主导航</li>
        <li class="active treeview">
          <a href="#">
            <i class="fa fa-users"></i> <span>账户中心</span>
            <i class="fa fa-angle-left pull-right"></i>
          </a>
          <ul class="treeview-menu">
            <li class="active"><a href="page1.html"><i class="fa fa-circle-o"></i> 账户管理</a></li>
            <li><a href="page2.html"><i class="fa fa-circle-o"></i> 角色管理</a></li>
          </ul>
        </li>
        <li class="treeview">
          <a href="page1.html">
            <i class="fa fa-cubes"></i> <span>管理中心</span>
            <i class="fa fa-angle-left pull-right"></i>
          </a>
          <ul class="treeview-menu">
            <li><a href="page4.html"><i class="fa fa-circle-o"></i> 支付类型</a></li>
            <li><a href="page5.html"><i class="fa fa-circle-o"></i> 交易类型</a></li>
            <li><a href="page6.html"><i class="fa fa-circle-o"></i> 明细类型</a></li>
          </ul>
        </li>
        <li class="treeview">
          <a href="page2.html">
            <i class="fa fa-dashboard"></i> <span>门店管理</span>
            <i class="fa fa-angle-left pull-right"></i>
          </a>
          <ul class="treeview-menu">
            <li><a href="page7.html"><i class="fa fa-circle-o"></i> 门店管理</a></li>
            <li><a href="page8.html"><i class="fa fa-circle-o"></i> 导购员管理</a></li>
          </ul>
        </li>
        <li class="treeview">
          <a href="page3.html">
            <i class="fa fa-database"></i> <span>基础数据管理</span>
            <i class="fa fa-angle-left pull-right"></i>
          </a>
          <ul class="treeview-menu">
            <li><a href="page9.html"><i class="fa fa-circle-o"></i> 颜色管理</a></li>
            <li><a href="page10.html"><i class="fa fa-circle-o"></i> 品类管理</a></li>
            <li><a href="page11.html"><i class="fa fa-circle-o"></i> 计量单位管理</a></li>
            <li><a href="page12.html"><i class="fa fa-circle-o"></i> 单位换算维护</a></li>
            <li><a href="page13.html"><i class="fa fa-circle-o"></i> 品牌管理</a></li>
            <li><a href="page14.html"><i class="fa fa-circle-o"></i> 物料管理</a></li>
          </ul>
        </li>
        <li class="treeview">
          <a href="page4.html">
            <i class="fa fa-credit-card"></i> <span>支付管理</span>
            <i class="fa fa-angle-left pull-right"></i>
          </a>
          <ul class="treeview-menu">
            <li><a href="page15.html"><i class="fa fa-circle-o"></i> 收银终端管理</a></li>
            <li><a href="page16.html"><i class="fa fa-circle-o"></i> 零售参数设定</a></li>
            <li><a href="page17.html"><i class="fa fa-circle-o"></i> 销售交易设定</a></li>
            <li><a href="page18.html"><i class="fa fa-circle-o"></i> 商户支付方式</a></li>
            <li><a href="page19.html"><i class="fa fa-circle-o"></i> 价格管理</a></li>
          </ul>
        </li>
        <li class="treeview">
          <a href="#">
            <i class="fa fa-cart-plus"></i> <span>促销管理</span>
            <i class="fa fa-angle-left pull-right"></i>
          </a>
          <ul class="treeview-menu">
            <li><a href="page20.html"><i class="fa fa-circle-o"></i> 促销活动管理</a></li>
            <li><a href="page21.html"><i class="fa fa-circle-o"></i> 促销支付限制</a></li>
            <li><a href="page22.html"><i class="fa fa-circle-o"></i> 促销优惠</a></li>
            <li><a href="page23.html"><i class="fa fa-circle-o"></i> 促销优惠匹配内容</a></li>
            <li><a href="page24.html"><i class="fa fa-circle-o"></i> 促销条件</a></li>
            <li><a href="page25.html"><i class="fa fa-circle-o"></i> 促销条件匹配内容</a></li>
            <li><a href="page26.html"><i class="fa fa-circle-o"></i> 促销门店</a></li>
          </ul>
        </li>
      </ul>
    </section>
    <!-- /.sidebar -->
  </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
  	<section class="content">
    	<div class="box">
            <div class="box-header with-border">
              <h3 class="box-title">修改头像</h3>
            </div>
            <div class="box-body">
            	<div id="settings" style="width:50%">
                <form id="uploadForm" action="http://localhost/crop.php" method="post" enctype="multipart/form-data">
                  <div class="form-group">
                  	<div class="row">
                    	<div id="jcropDive" class="col-sm-10" style="width:500px; padding:0; margin:0 15px;">
                        	<img src="" id="jcrop" width="500" height="370" style="display:none" />
                        	<input id="file" type="file" name="file" onChange="upload()">
                        </div>
                        <div id="previewDiv" class="col-sm-2" style="width:150px; height:150px; padding:0; margin:0 15px; display:none; overflow:hidden;">
                        	<img src="" id="preview"/>
                        </div>
                    </div>
                  </div>
                  <div class="form-group">
                  	  <input type="hidden" id="final" name="final" value="1" />
                  	  <input type="hidden" id="x" name="x" />
                      <input type="hidden" id="y" name="y" />
                      <input type="hidden" id="w" name="w" />
                      <input type="hidden" id="h" name="h" />
                      <button type="submit" class="btn btn-danger">提交</button> <button type="button" class="btn btn-default" onClick="cancel();">取消</button>
                  </div>
                </form>
              </div>
            </div>
     </div>
    </section>
  </div>
  <!-- /.content-wrapper -->
</div>
<!-- ./wrapper -->
<script src="plugins/jQuery/jQuery-2.2.0.min.js"></script> 
<script src="bootstrap/js/bootstrap.min.js"></script> 
<script src="plugins/select2/select2.full.min.js" type="text/javascript"></script>
<script src="dist/js/ajaxfileupload.js"></script>
<link rel="stylesheet" href="plugins/Jcrop/jquery.Jcrop.min.css" type="text/css" />
<script src="plugins/Jcrop/jquery.Jcrop.min.js"></script>
<script src="dist/js/app.js"></script>
<script>
$(function(){
	$('.select2').select2();
})

function upload(){
	$.ajaxFileUpload({
		url: 'http://localhost/crop.php', //用于文件上传的服务器端请求地址
		secureuri: false, //是否需要安全协议，一般设置为false
		fileElementId: 'file', //文件上传域的ID
		dataType: 'json', //返回值类型 一般设置为json
		success: function (data, status){  //服务器成功响应处理函数
			init(data.imgurl);
			if (typeof (data.error) != 'undefined') {
				if (data.error != '') {
					alert(data.error);
				} else {
					alert(data.msg);
				}
			}
		},
		error: function (data, status, e){ //服务器响应失败处理函数
			alert(e);
		}
	});
	return false;
}

function cancel(){
	$('#file').val('').show();
	$('#previewDiv, .jcrop-holder').hide();
	$("#jcrop, #preview").attr("src", '').hide();
}

function init(imgurl){
	$('#file').hide();
	$('#previewDiv').show();
	$("#jcrop, #preview").attr("src", 'http://localhost'+imgurl).show();
	$.Jcrop('#jcrop').setSelect([140,70,340,270]);
	$('#jcrop').Jcrop({
		onChange: showPreview,
		onSelect: showPreview,
		aspectRatio: 1
	});
}
function showPreview(coords){
	var rx = 150 / coords.w;
	var ry = 150 / coords.h;

	$('#preview').css({
		width: Math.round(rx * 500) + 'px',
		height: Math.round(ry * 370) + 'px',
		marginLeft: '-' + Math.round(rx * coords.x) + 'px',
		marginTop: '-' + Math.round(ry * coords.y) + 'px'
	});
	
	$('#w').val(coords.w);
	$('#h').val(coords.h);
	$('#x').val(coords.x);
	$('#y').val(coords.y);
}
</script>
</body>
</html>
